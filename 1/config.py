__author__ = 'Jiri Fajtl'
__email__ = 'ok1zjf@gmail.com'
__version__= '3.6'
__status__ = "Research"
__date__ = "1/12/2018"
__license__= "MIT License"

from torch.autograd import Variable

import time
import signal


def signal_handler(signal, frame):
    print('You pressed Ctrl+C!')


signal.signal(signal.SIGINT, signal_handler)
print('Press Ctrl+C')



class HParameters:

    def __init__(self):
        self.verbose = False
        self.use_cuda = True
        self.cuda_device = 0
        self.max_summary_length = 0.15

        self.l2_req = 0.00001
        self.lr_epochs = [0]
        self.lr = [0.00005]
        #
        self.epochs_max = 40
        self.train_batch_size = 1

        self.output_dir = 'ex-10'

        self.root = ''

        ##midmacro
        self.datasets = [
            'datasets/036_7.h5',
            'datasets/037_4.h5',
            'datasets/035_2.h5',
            'datasets/014_6.h5',
            'datasets/033_5.h5',
            'datasets/009_4.h5',
            'datasets/006_1.h5',
            'datasets/012_5.h5',
            'datasets/030_1.h5',
            'datasets/011_6.h5',
            'datasets/014_1.h5',
            'datasets/006_2.h5',
            'datasets/022_2.h5',
            'datasets/014_3.h5',
            'datasets/018_6.h5',
            'datasets/012_6.h5',
            'datasets/020_4.h5',
            'datasets/013_6.h5',
            'datasets/014_7.h5',
            'datasets/010_6.h5',
            'datasets/008_5.h5',
            'datasets/033_3.h5',
            'datasets/036_6.h5',
            'datasets/032_3.h5',
            'datasets/037_2.h5',
            'datasets/035_7.h5',
            'datasets/035_3.h5',
            'datasets/026_2.h5',
            'datasets/006_5.h5',
            'datasets/035_4.h5',
            'datasets/017_5.h5',
            'datasets/035_1.h5',
            'datasets/006_6.h5',
            'datasets/020_1.h5',
            'datasets/015_7.h5',
            'datasets/030_2.h5',
            'datasets/036_9.h5',
            'datasets/017_1.h5',
            'datasets/033_2.h5',
            'datasets/025_3.h5',
            'datasets/007_5.h5',
            'datasets/019_7.h5',
            'datasets/024_5.h5',
            'datasets/026_3.h5',
            'datasets/017_4.h5',
            'datasets/030_5.h5',
            'datasets/037_3.h5',
            'datasets/009_7.h5',
            'datasets/036_4.h5',
            'datasets/020_3.h5',
            'datasets/017_6.h5',
            'datasets/024_3.h5',
            'datasets/015_3.h5',
            'datasets/036_2.h5',
            'datasets/010_3.h5',
            'datasets/014_2.h5',
            'datasets/015_1.h5',
            'datasets/013_2.h5',
            'datasets/016_6.h5',
            'datasets/013_1.h5',
            'datasets/011_1.h5',
            'datasets/019_2.h5',
            'datasets/010_7.h5',
            'datasets/019_5.h5',
            'datasets/010_1.h5',
            'datasets/012_7.h5',
            'datasets/006_3.h5',
            'datasets/033_4.h5',
            'datasets/037_7.h5',
            'datasets/034_6.h5',
            'datasets/020_2.h5',
            'datasets/020_7.h5',
            'datasets/013_3.h5',
            'datasets/026_7.h5',
            'datasets/015_6.h5',
            'datasets/032_2.h5',
            'datasets/028_4.h5',
            'datasets/018_2.h5',
            'datasets/007_6.h5',
            'datasets/032_4.h5',
            'datasets/011_7.h5',
            'datasets/014_4.h5',
            'datasets/010_4.h5',
            'datasets/023_4.h5',
            'datasets/024_2.h5',
            'datasets/016_5.h5',
            'datasets/035_6.h5',
            'datasets/011_3.h5',
            'datasets/016_2.h5',
            'datasets/019_3.h5',
            'datasets/020_5.h5',
            'datasets/036_8.h5',
            'datasets/022_6.h5',
            'datasets/025_5.h5',
            'datasets/018_4.h5',
            'datasets/011_5.h5',
            'datasets/008_1.h5',
            'datasets/033_7.h5',
            'datasets/017_3.h5',
            'datasets/034_7.h5',
            'datasets/017_2.h5',
            'datasets/009_3.h5',
            'datasets/022_3.h5',
            'datasets/016_1.h5',
            'datasets/013_7.h5',
            'datasets/018_7.h5',
            'datasets/032_5.h5',
            'datasets/010_2.h5',
            'datasets/037_5.h5',
            'datasets/015_5.h5',
            'datasets/018_5.h5',
            'datasets/007_7.h5',
            'datasets/010_5.h5',
            'datasets/008_6.h5',
            'datasets/006_7.h5',
            'datasets/020_6.h5',
            'datasets/011_2.h5',
            'datasets/012_4.h5',
            'datasets/016_4.h5',
            'datasets/009_6.h5',
            'datasets/021_3.h5',
            'datasets/033_1.h5',
            'datasets/011_4.h5',
            'datasets/014_5.h5',
            'datasets/016_7.h5',
            'datasets/033_6.h5',
            'datasets/032_6.h5',
            'datasets/006_4.h5',
            'datasets/008_7.h5',
            'datasets/018_3.h5',
            'datasets/019_1.h5']
        ##micro
        # self.datasets = [
        # 'datasets/009_2_1.h5',
        # 'datasets/011_3_6.h5',
        # 'datasets/012_3_2.h5',
        # 'datasets/037_3_2.h5',
        # 'datasets/019_3_2.h5',
        # 'datasets/022_2_3.h5',
        # 'datasets/025_5_1.h5',
        # 'datasets/020_7_2.h5',
        # 'datasets/022_5_1.h5',
        # 'datasets/033_1_4.h5',
        # 'datasets/014_3_4.h5',
        # 'datasets/014_6_3.h5',
        # 'datasets/013_7_7.h5',
        # 'datasets/006_2_4.h5',
        # 'datasets/035_1_1.h5',
        # 'datasets/035_4_1.h5',
        # 'datasets/014_3_3.h5',
        # 'datasets/011_6_6.h5',
        # 'datasets/009_3_2.h5',
        # 'datasets/011_4_1.h5',
        # 'datasets/026_1_2.h5',
        # 'datasets/020_4_2.h5',
        # 'datasets/012_7_1.h5',
        # 'datasets/011_4_2.h5',
        # 'datasets/011_2_1.h5',
        # 'datasets/026_5_1.h5',
        # 'datasets/025_4_2.h5',
        # 'datasets/006_1_5.h5',
        # 'datasets/026_2_2.h5',
        # 'datasets/035_5_1.h5',
        # 'datasets/016_7_8.h5',
        # 'datasets/018_5_1.h5',
        # 'datasets/030_1_1.h5',
        # 'datasets/019_4_1.h5',
        # 'datasets/017_3_4.h5',
        # 'datasets/035_4_2.h5',
        # 'datasets/017_3_2.h5',
        # 'datasets/011_1_4.h5',
        # 'datasets/025_6_1.h5',
        # 'datasets/007_5_4.h5',
        # 'datasets/007_6_5.h5',
        # 'datasets/010_2_1.h5',
        # 'datasets/014_1_5.h5',
        # 'datasets/011_4_13.h5',
        # 'datasets/032_3_1.h5',
        # 'datasets/025_4_1.h5',
        # 'datasets/021_7_2.h5',
        # 'datasets/013_1_8.h5',
        # 'datasets/026_6_1.h5',
        # 'datasets/017_3_1.h5',
        # 'datasets/022_3_2.h5',
        # 'datasets/033_2_1.h5',
        # 'datasets/035_6_3.h5',
        # 'datasets/017_3_3.h5',
        # 'datasets/020_1_4.h5',
        # 'datasets/026_2_4.h5',
        # 'datasets/028_4_1.h5',
        # 'datasets/020_1_3.h5',
        # 'datasets/020_1_1.h5',
        # 'datasets/006_5_11.h5',
        # 'datasets/010_4_1.h5',
        # 'datasets/034_7_3.h5',
        # 'datasets/007_4_2.h5',
        # 'datasets/037_3_1.h5',
        # 'datasets/007_3_1.h5',
        # 'datasets/034_3_1.h5',
        # 'datasets/006_5_9.h5',
        # 'datasets/006_3_4.h5',
        # 'datasets/026_2_3.h5',
        # 'datasets/035_5_2.h5',
        # 'datasets/036_7_3.h5',
        # 'datasets/026_3_3.h5',
        # 'datasets/020_7_10.h5',
        # 'datasets/011_3_4.h5',
        # 'datasets/011_7_10.h5',
        # 'datasets/035_7_2.h5',
        # 'datasets/033_1_5.h5',
        # 'datasets/016_7_1.h5',
        # 'datasets/011_6_1.h5',
        # 'datasets/026_7_1.h5',
        # 'datasets/032_4_1.h5',
        # 'datasets/018_1_4.h5',
        # 'datasets/033_2_2.h5',
        # 'datasets/031_3_1.h5',
        # 'datasets/034_7_2.h5',
        # 'datasets/013_1_10.h5',
        # 'datasets/013_1_12.h5',
        # 'datasets/014_1_1.h5',
        # 'datasets/006_3_5.h5',
        # 'datasets/014_5_2.h5',
        # 'datasets/037_4_1.h5',
        # 'datasets/011_2_7.h5',
        # 'datasets/026_3_4.h5',
        # 'datasets/035_5_3.h5',
        # 'datasets/026_1_1.h5',
        # 'datasets/015_5_2.h5',
        # 'datasets/011_2_2.h5',
        # 'datasets/032_6_1.h5',
        # 'datasets/006_1_4.h5',
        # 'datasets/021_7_1.h5',
        # 'datasets/014_7_1.h5',
        # 'datasets/011_6_13.h5',
        # 'datasets/009_3_3.h5',
        # 'datasets/016_7_5.h5',
        # 'datasets/007_5_3.h5',
        # 'datasets/019_5_1.h5',
        # 'datasets/032_4_2.h5',
        # 'datasets/011_3_1.h5',
        # 'datasets/006_1_3.h5',
        # 'datasets/007_6_3.h5',
        # 'datasets/020_1_2.h5',
        # 'datasets/011_5_1.h5',
        # 'datasets/026_2_1.h5',
        # 'datasets/006_5_10.h5',
        # 'datasets/011_2_3.h5',
        # 'datasets/033_1_3.h5',
        # 'datasets/011_7_1.h5',
        # 'datasets/024_2_1.h5',
        # 'datasets/020_4_1.h5',
        # 'datasets/022_3_3.h5',
        # 'datasets/018_7_1.h5',
        # 'datasets/026_7_2.h5',
        # 'datasets/010_4_2.h5',
        # 'datasets/012_3_1.h5',
        # 'datasets/011_4_12.h5',
        # 'datasets/015_5_1.h5',
        # 'datasets/018_3_1.h5',
        # 'datasets/015_5_3.h5',
        # 'datasets/020_7_1.h5',
        # 'datasets/014_2_3.h5',
        # 'datasets/028_4_3.h5',
        # 'datasets/006_1_2.h5',
        # 'datasets/009_3_4.h5',
        # 'datasets/006_1_6.h5',
        # 'datasets/011_6_5.h5',
        # 'datasets/014_6_2.h5',
        # 'datasets/017_6_2.h5',
        # 'datasets/007_6_2.h5',
        # 'datasets/030_1_2.h5',
        # 'datasets/007_7_5.h5',
        # 'datasets/013_1_11.h5',
        # 'datasets/032_3_3.h5',
        # 'datasets/011_3_5.h5',
        # 'datasets/016_7_3.h5',
        # 'datasets/007_6_1.h5',
        # 'datasets/023_1_1.h5',
        # 'datasets/028_4_4.h5',
        # 'datasets/035_7_1.h5',
        # 'datasets/013_1_9.h5',
        # 'datasets/017_6_1.h5',
        # 'datasets/007_7_1.h5',
        # 'datasets/022_4_1.h5',
        # 'datasets/026_7_3.h5',
        # 'datasets/016_7_2.h5',
        # 'datasets/032_3_2.h5',
        # 'datasets/010_2_8.h5',
        # 'datasets/014_2_4.h5',
        # 'datasets/030_5_1.h5',
        # 'datasets/014_6_1.h5']
        ##

        ##macro
        # self.datasets =[
        # 'datasets/006_4_3.h5',
        # 'datasets/020_2_1.h5',
        # 'datasets/026_3_2.h5',
        # 'datasets/006_6_3.h5',
        # 'datasets/008_5_1.h5',
        # 'datasets/025_3_4.h5',
        # 'datasets/014_7_2.h5',
        # 'datasets/011_1_3.h5',
        # 'datasets/019_5_4.h5',
        # 'datasets/007_7_4.h5',
        # 'datasets/011_5_3.h5',
        # 'datasets/016_7_7.h5',
        # 'datasets/020_6_3.h5',
        # 'datasets/017_3_6.h5',
        # 'datasets/020_7_8.h5',
        # 'datasets/011_5_8.h5',
        # 'datasets/020_6_2.h5',
        # 'datasets/010_5_1.h5',
        # 'datasets/018_6_4.h5',
        # 'datasets/036_2_4.h5',
        # 'datasets/018_4_1.h5',
        # 'datasets/036_7_2.h5',
        # 'datasets/013_1_4.h5',
        # 'datasets/010_7_1.h5',
        # 'datasets/010_2_3.h5',
        # 'datasets/006_4_2.h5',
        # 'datasets/022_2_5.h5',
        # 'datasets/011_5_6.h5',
        # 'datasets/020_3_2.h5',
        # 'datasets/011_6_3.h5',
        # 'datasets/011_4_7.h5',
        # 'datasets/026_3_6.h5',
        # 'datasets/010_1_3.h5',
        # 'datasets/006_3_3.h5',
        # 'datasets/014_6_5.h5',
        # 'datasets/010_4_3.h5',
        # 'datasets/013_7_6.h5',
        # 'datasets/025_3_2.h5',
        # 'datasets/020_1_8.h5',
        # 'datasets/006_5_1.h5',
        # 'datasets/036_4_1.h5',
        # 'datasets/034_7_6.h5',
        # 'datasets/018_2_2.h5',
        # 'datasets/019_1_6.h5',
        # 'datasets/010_3_4.h5',
        # 'datasets/015_6_1.h5',
        # 'datasets/018_4_4.h5',
        # 'datasets/020_7_6.h5',
        # 'datasets/015_7_2.h5',
        # 'datasets/009_3_6.h5',
        # 'datasets/011_7_7.h5',
        # 'datasets/011_4_5.h5',
        # 'datasets/014_1_2.h5',
        # 'datasets/011_5_10.h5',
        # 'datasets/022_3_1.h5',
        # 'datasets/015_1_2.h5',
        # 'datasets/011_2_9.h5',
        # 'datasets/035_2_1.h5',
        # 'datasets/011_6_10.h5',
        # 'datasets/033_2_3.h5',
        # 'datasets/011_3_7.h5',
        # 'datasets/037_5_1.h5',
        # 'datasets/011_6_2.h5',
        # 'datasets/037_4_2.h5',
        # 'datasets/020_5_4.h5',
        # 'datasets/010_2_4.h5',
        # 'datasets/012_6_2.h5',
        # 'datasets/019_3_3.h5',
        # 'datasets/018_4_6.h5',
        # 'datasets/022_2_2.h5',
        # 'datasets/034_6_2.h5',
        # 'datasets/010_2_6.h5',
        # 'datasets/006_6_2.h5',
        # 'datasets/011_7_12.h5',
        # 'datasets/035_7_5.h5',
        # 'datasets/035_4_3.h5',
        # 'datasets/010_3_2.h5',
        # 'datasets/006_4_1.h5',
        # 'datasets/012_6_1.h5',
        # 'datasets/020_3_1.h5',
        # 'datasets/009_3_5.h5',
        # 'datasets/012_6_3.h5',
        # 'datasets/026_2_5.h5',
        # 'datasets/014_5_3.h5',
        # 'datasets/009_6_1.h5',
        # 'datasets/014_6_6.h5',
        # 'datasets/012_4_1.h5',
        # 'datasets/015_6_3.h5',
        # 'datasets/036_2_3.h5',
        # 'datasets/016_1_2.h5',
        # 'datasets/006_5_6.h5',
        # 'datasets/019_5_2.h5',
        # 'datasets/017_1_1.h5',
        # 'datasets/008_7_1.h5',
        # 'datasets/011_7_4.h5',
        # 'datasets/035_2_2.h5',
        # 'datasets/015_1_1.h5',
        # 'datasets/011_4_9.h5',
        # 'datasets/037_7_1.h5',
        # 'datasets/013_6_1.h5',
        # 'datasets/035_3_2.h5',
        # 'datasets/011_1_1.h5',
        # 'datasets/014_4_1.h5',
        # 'datasets/006_2_1.h5',
        # 'datasets/024_2_3.h5',
        # 'datasets/013_2_1.h5',
        # 'datasets/015_6_2.h5',
        # 'datasets/011_5_12.h5',
        # 'datasets/034_6_1.h5',
        # 'datasets/012_6_4.h5',
        # 'datasets/025_3_3.h5',
        # 'datasets/006_2_2.h5',
        # 'datasets/012_7_3.h5',
        # 'datasets/011_7_8.h5',
        # 'datasets/009_4_1.h5',
        # 'datasets/011_4_4.h5',
        # 'datasets/030_1_3.h5',
        # 'datasets/018_4_5.h5',
        # 'datasets/036_6_1.h5',
        # 'datasets/006_7_1.h5',
        # 'datasets/030_2_1.h5',
        # 'datasets/020_4_3.h5',
        # 'datasets/035_3_1.h5',
        # 'datasets/024_3_4.h5',
        # 'datasets/033_3_1.h5',
        # 'datasets/011_7_5.h5',
        # 'datasets/032_2_5.h5',
        # 'datasets/018_2_1.h5',
        # 'datasets/016_6_3.h5',
        # 'datasets/014_3_2.h5',
        # 'datasets/011_3_2.h5',
        # 'datasets/009_7_1.h5',
        # 'datasets/011_4_8.h5',
        # 'datasets/007_5_1.h5',
        # 'datasets/020_1_6.h5',
        # 'datasets/016_7_4.h5',
        # 'datasets/020_4_5.h5',
        # 'datasets/018_6_2.h5',
        # 'datasets/032_6_2.h5',
        # 'datasets/010_6_1.h5',
        # 'datasets/019_5_3.h5',
        # 'datasets/022_3_4.h5',
        # 'datasets/035_7_4.h5',
        # 'datasets/010_2_10.h5',
        # 'datasets/011_3_3.h5',
        # 'datasets/014_5_1.h5',
        # 'datasets/006_3_2.h5',
        # 'datasets/008_1_1.h5',
        # 'datasets/012_3_4.h5',
        # 'datasets/011_6_7.h5',
        # 'datasets/018_7_2.h5',
        # 'datasets/015_3_1.h5',
        # 'datasets/036_4_2.h5',
        # 'datasets/033_1_2.h5',
        # 'datasets/011_7_2.h5',
        # 'datasets/010_2_7.h5',
        # 'datasets/033_2_4.h5',
        # 'datasets/018_5_5.h5',
        # 'datasets/018_5_4.h5',
        # 'datasets/014_2_1.h5',
        # 'datasets/013_7_2.h5',
        # 'datasets/006_6_1.h5',
        # 'datasets/023_4_1.h5',
        # 'datasets/026_2_6.h5',
        # 'datasets/035_6_2.h5',
        # 'datasets/030_1_4.h5',
        # 'datasets/011_5_11.h5',
        # 'datasets/006_7_2.h5',
        # 'datasets/037_4_3.h5',
        # 'datasets/037_4_1.h5',
        # 'datasets/020_4_4.h5',
        # 'datasets/008_6_1.h5',
        # 'datasets/033_7_1.h5',
        # 'datasets/035_1_2.h5',
        # 'datasets/030_5_2.h5',
        # 'datasets/014_2_2.h5',
        # 'datasets/015_5_4.h5',
        # 'datasets/028_4_5.h5',
        # 'datasets/016_7_6.h5',
        # 'datasets/006_4_4.h5',
        # 'datasets/011_6_9.h5',
        # 'datasets/014_3_5.h5',
        # 'datasets/006_5_12.h5',
        # 'datasets/014_7_5.h5',
        # 'datasets/011_5_5.h5',
        # 'datasets/032_4_4.h5',
        # 'datasets/035_6_4.h5',
        # 'datasets/016_4_1.h5',
        # 'datasets/011_4_10.h5',
        # 'datasets/033_4_1.h5',
        # 'datasets/010_3_3.h5',
        # 'datasets/006_1_7.h5',
        # 'datasets/018_4_2.h5',
        # 'datasets/024_5_1.h5',
        # 'datasets/036_7_7.h5',
        # 'datasets/013_1_2.h5',
        # 'datasets/012_3_3.h5',
        # 'datasets/020_1_5.h5',
        # 'datasets/032_4_3.h5',
        # 'datasets/013_1_3.h5',
        # 'datasets/037_2_1.h5',
        # 'datasets/014_7_3.h5',
        # 'datasets/011_6_8.h5',
        # 'datasets/015_5_5.h5',
        # 'datasets/010_5_2.h5',
        # 'datasets/011_2_8.h5',
        # 'datasets/020_6_1.h5',
        # 'datasets/007_7_3.h5',
        # 'datasets/011_6_11.h5',
        # 'datasets/013_7_5.h5',
        # 'datasets/011_5_2.h5',
        # 'datasets/036_2_2.h5',
        # 'datasets/019_1_4.h5',
        # 'datasets/022_2_1.h5',
        # 'datasets/014_3_1.h5',
        # 'datasets/036_7_1.h5',
        # 'datasets/020_7_9.h5',
        # 'datasets/015_7_1.h5',
        # 'datasets/013_7_1.h5',
        # 'datasets/011_4_14.h5',
        # 'datasets/032_2_2.h5',
        # 'datasets/019_1_3.h5',
        # 'datasets/018_6_5.h5',
        # 'datasets/011_7_11.h5',
        # 'datasets/016_7_9.h5',
        # 'datasets/011_7_6.h5',
        # 'datasets/018_4_9.h5',
        # 'datasets/025_5_6.h5',
        # 'datasets/036_7_6.h5',
        # 'datasets/006_3_1.h5',
        # 'datasets/016_6_2.h5',
        # 'datasets/011_5_4.h5',
        # 'datasets/014_4_2.h5',
        # 'datasets/008_7_2.h5',
        # 'datasets/019_1_1.h5',
        # 'datasets/013_7_4.h5',
        # 'datasets/020_7_4.h5',
        # 'datasets/020_6_4.h5',
        # 'datasets/013_2_2.h5',
        # 'datasets/018_5_3.h5',
        # 'datasets/036_7_8.h5',
        # 'datasets/014_6_4.h5',
        # 'datasets/035_2_3.h5',
        # 'datasets/011_7_9.h5',
        # 'datasets/017_5_1.h5',
        # 'datasets/036_4_3.h5',
        # 'datasets/010_2_2.h5',
        # 'datasets/024_2_2.h5',
        # 'datasets/019_7_2.h5',
        # 'datasets/025_3_1.h5',
        # 'datasets/033_7_2.h5',
        # 'datasets/024_3_3.h5',
        # 'datasets/017_6_3.h5',
        # 'datasets/024_3_2.h5',
        # 'datasets/022_2_4.h5',
        # 'datasets/032_5_1.h5',
        # 'datasets/007_6_4.h5',
        # 'datasets/014_1_3.h5',
        # 'datasets/024_3_1.h5',
        # 'datasets/016_2_1.h5',
        # 'datasets/011_4_6.h5',
        # 'datasets/026_3_5.h5',
        # 'datasets/014_4_3.h5',
        # 'datasets/032_2_4.h5',
        # 'datasets/021_3_2.h5',
        # 'datasets/013_1_13.h5',
        # 'datasets/028_4_2.h5',
        # 'datasets/022_6_1.h5',
        # 'datasets/025_3_5.h5',
        # 'datasets/011_4_3.h5',
        # 'datasets/032_3_4.h5',
        # 'datasets/035_7_6.h5',
        # 'datasets/006_5_3.h5',
        # 'datasets/011_6_12.h5',
        # 'datasets/018_6_3.h5',
        # 'datasets/006_6_4.h5',
        # 'datasets/011_5_7.h5',
        # 'datasets/019_1_2.h5',
        # 'datasets/011_4_11.h5',
        # 'datasets/019_2_1.h5',
        # 'datasets/010_2_5.h5',
        # 'datasets/010_2_9.h5',
        # 'datasets/006_5_7.h5',
        # 'datasets/015_5_6.h5',
        # 'datasets/020_6_5.h5',
        # 'datasets/034_7_5.h5',
        # 'datasets/012_5_1.h5',
        # 'datasets/010_1_2.h5',
        # 'datasets/018_3_2.h5',
        # 'datasets/015_1_3.h5',
        # 'datasets/036_6_2.h5',
        # 'datasets/020_7_7.h5',
        # 'datasets/018_4_8.h5',
        # 'datasets/018_6_1.h5',
        # 'datasets/010_3_1.h5',
        # 'datasets/015_6_5.h5',
        # 'datasets/007_7_2.h5',
        # 'datasets/020_7_11.h5',
        # 'datasets/035_6_1.h5',
        # 'datasets/032_2_3.h5',
        # 'datasets/006_5_5.h5',
        # 'datasets/019_7_1.h5',
        # 'datasets/037_3_3.h5',
        # 'datasets/006_1_1.h5',
        # 'datasets/013_7_3.h5',
        # 'datasets/018_4_7.h5',
        # 'datasets/033_1_1.h5',
        # 'datasets/020_7_3.h5',
        # 'datasets/015_6_4.h5',
        # 'datasets/019_5_5.h5',
        # 'datasets/009_3_1.h5',
        # 'datasets/036_7_4.h5',
        # 'datasets/011_6_4.h5',
        # 'datasets/026_2_7.h5',
        # 'datasets/011_2_4.h5',
        # 'datasets/014_7_4.h5',
        # 'datasets/030_5_3.h5',
        # 'datasets/036_6_3.h5',
        # 'datasets/014_7_6.h5',
        # 'datasets/036_2_1.h5',
        # 'datasets/033_6_1.h5',
        # 'datasets/026_3_1.h5',
        # 'datasets/018_4_3.h5',
        # 'datasets/011_5_9.h5',
        # 'datasets/018_3_3.h5',
        # 'datasets/037_3_4.h5',
        # 'datasets/037_5_2.h5',
        # 'datasets/017_4_1.h5',
        # 'datasets/016_5_2.h5',
        # 'datasets/020_7_5.h5',
        # 'datasets/013_3_1.h5',
        # 'datasets/033_1_9.h5',
        # 'datasets/021_3_1.h5',
        # 'datasets/015_3_2.h5',
        # 'datasets/019_1_5.h5',
        # 'datasets/011_1_2.h5',
        # 'datasets/033_5_1.h5',
        # 'datasets/011_7_3.h5',
        # 'datasets/036_6_4.h5',
        # 'datasets/017_2_2.h5',
        # 'datasets/016_1_1.h5',
        # 'datasets/032_2_1.h5',
        # 'datasets/026_7_4.h5']

        # self.datasets=[
        #     'datasets/whq1anger1_1.h5',
        #     'datasets/whq1anger1_2.h5',
        #     'datasets/whq1anger2_1.h5',
        #     'datasets/whq1anger2_2.h5',
        #     'datasets/whq1anger2_3.h5',
        #     'datasets/whq1anger2_4.h5',
        #     'datasets/whq1anger2_5.h5',
        #     'datasets/whq1disgust1_1.h5',
        #     'datasets/whq1disgust2_1.h5',
        #     'datasets/whq1disgust2_2.h5',
        #     'datasets/whq1disgust2_3.h5',
        #     'datasets/whq1disgust2_4.h5',
        #     'datasets/whq1happy1_1.h5',
        #     'datasets/whq1happy1_2.h5',
        #     'datasets/whq1happy1_3.h5',
        #     'datasets/whq1happy2_1.h5',
        #     'datasets/whq1happy3_1.h5',
        #     'datasets/whq2anger1_1.h5',
        #     'datasets/whq2anger1_2.h5',
        #     'datasets/whq2anger1_3.h5',
        #     'datasets/whq2anger1_4.h5',
        #     'datasets/whq2anger2_1.h5',
        #     'datasets/whq2anger2_2.h5',
        #     'datasets/whq2anger2_3.h5',
        #     'datasets/whq2anger2_4.h5',
        #     'datasets/whq2anger2_5.h5',
        #     'datasets/whq2anger2_6.h5',
        #     'datasets/whq2anger2_7.h5',
        #     'datasets/whq2anger2_8.h5',
        #     'datasets/whq2anger2_9.h5',
        #     'datasets/whq2disgust1_1.h5',
        #     'datasets/whq2disgust1_2.h5',
        #     'datasets/whq2disgust1_3.h5',
        #     'datasets/whq2disgust1_4.h5',
        #     'datasets/whq2disgust1_5.h5',
        #     'datasets/whq2disgust1_6.h5',
        #     'datasets/whq2disgust1_7.h5',
        #     'datasets/whq2disgust1_8.h5',
        #     'datasets/whq2disgust2_1.h5',
        #     'datasets/whq2disgust2_2.h5',
        #     'datasets/whq2disgust2_3.h5',
        #     'datasets/whq2disgust2_4.h5',
        #     'datasets/whq2disgust2_5.h5',
        #     'datasets/whq2disgust2_6.h5',
        #     'datasets/whq2disgust2_7.h5',
        #     'datasets/whq2disgust2_8.h5',
        #     'datasets/whq2disgust2_9.h5',
        #     'datasets/whq2happy1_1.h5',
        #     'datasets/whq2happy1_2.h5',
        #     'datasets/whq2happy1_3.h5',
        #     'datasets/whq2happy1_4.h5',
        #     'datasets/whq2happy1_5.h5',
        #     'datasets/whq2happy1_6.h5',
        #     'datasets/whq2happy1_7.h5',
        #     'datasets/whq2happy3_1.h5',
        #     'datasets/whq2happy3_10.h5',
        #     'datasets/whq2happy3_11.h5',
        #     'datasets/whq2happy3_2.h5',
        #     'datasets/whq2happy3_3.h5',
        #     'datasets/whq2happy3_4.h5',
        #     'datasets/whq2happy3_5.h5',
        #     'datasets/whq2happy3_6.h5',
        #     'datasets/whq2happy3_7.h5',
        #     'datasets/whq2happy3_8.h5',
        #     'datasets/whq2happy3_9.h5',
        #     'datasets/whq2happy4_1.h5',
        #     'datasets/whq2happy4_2.h5',
        #     'datasets/whq2happy4_3.h5',
        #     'datasets/whq2happy4_4.h5',
        #     'datasets/whq2happy4_5.h5',
        #     'datasets/whq2happy4_6.h5',
        #     'datasets/whq3anger2_1.h5',
        #     'datasets/whq3disgust2_1.h5',
        #     'datasets/whq3disgust2_2.h5',
        #     'datasets/whq3happy3_1.h5',
        #     'datasets/whq3happy4_1.h5',
        #     'datasets/whq4happy1_1.h5',
        #     'datasets/whq4happy1_2.h5',
        #     'datasets/whq4happy1_3.h5',
        #     'datasets/whq5anger1_1.h5',
        #     'datasets/whq5disgust1_1.h5',
        #     'datasets/whq6anger2_1.h5',
        #     'datasets/whq6disgust1_1.h5',
        #     'datasets/whq6disgust1_10.h5',
        #     'datasets/whq6disgust1_2.h5',
        #     'datasets/whq6disgust1_3.h5',
        #     'datasets/whq6disgust1_4.h5',
        #     'datasets/whq6disgust1_5.h5',
        #     'datasets/whq6disgust1_6.h5',
        #     'datasets/whq6disgust1_7.h5',
        #     'datasets/whq6disgust1_8.h5',
        #     'datasets/whq6disgust1_9.h5',
        #     'datasets/whq6disgust2_1.h5',
        #     'datasets/whq6disgust2_2.h5',
        #     'datasets/whq6disgust2_3.h5',
        #     'datasets/whq6happy2_1.h5',
        #     'datasets/whq6happy5_1.h5',
        #     'datasets/whq7anger2_1.h5',
        #     'datasets/whq7anger2_2.h5',
        #     'datasets/whq7anger2_3.h5',
        #     'datasets/whq7disgust2_1.h5',
        #     'datasets/whq7disgust2_2.h5',
        #     'datasets/whq7disgust2_3.h5',
        #     'datasets/whq7disgust2_4.h5',
        #     'datasets/whq7disgust2_5.h5',
        #     'datasets/whq7happy1_1.h5',
        #     'datasets/whq7happy1_2.h5',
        #     'datasets/whq8anger1_1.h5',
        #     'datasets/whq8anger1_10.h5',
        #     'datasets/whq8anger1_11.h5',
        #     'datasets/whq8anger1_12.h5',
        #     'datasets/whq8anger1_2.h5',
        #     'datasets/whq8anger1_3.h5',
        #     'datasets/whq8anger1_4.h5',
        #     'datasets/whq8anger1_5.h5',
        #     'datasets/whq8anger1_6.h5',
        #     'datasets/whq8anger1_7.h5',
        #     'datasets/whq8anger1_8.h5',
        #     'datasets/whq8anger1_9.h5',
        #     'datasets/whq8anger2_1.h5',
        #     'datasets/whq8anger2_2.h5',
        #     'datasets/whq8disgust1_1.h5',
        #     'datasets/whq8disgust1_2.h5',
        #     'datasets/whq8happy1_1.h5',
        #     'datasets/whq8happy1_2.h5',
        #     'datasets/whq8happy1_3.h5',
        #     'datasets/whq9disgust1_1.h5',
        #     'datasets/whq9disgust2_1.h5',
        #     'datasets/whq9disgust2_2.h5',
        #     'datasets/whq9disgust2_3.h5',
        #     'datasets/whq9disgust2_4.h5',
        #     'datasets/whq9happy1_1.h5',
        #     'datasets/whq9happy1_2.h5',
        #     'datasets/whq9happy5_1.h5',
        #     'datasets/whq9happy5_2.h5',
        #     'datasets/whq10anger1_1.h5',
        #     'datasets/whq10disgust1_1.h5',
        #     'datasets/whq10disgust2_1.h5',
        #     'datasets/whq10disgust2_2.h5',
        #     'datasets/whq10happy2_1.h5',
        #     'datasets/whq10happy2_2.h5',
        #     'datasets/whq11anger1_1.h5',
        #     'datasets/whq11anger1_2.h5',
        #     'datasets/whq11anger1_3.h5',
        #     'datasets/whq11anger1_4.h5',
        #     'datasets/whq11anger1_5.h5',
        #     'datasets/whq11anger1_6.h5',
        #     'datasets/whq11anger1_7.h5',
        #     'datasets/whq11anger1_8.h5',
        #     'datasets/whq11anger2_1.h5',
        #     'datasets/whq11anger2_2.h5',
        #     'datasets/whq11disgust1_1.h5',
        #     'datasets/whq11disgust1_2.h5',
        #     'datasets/whq11disgust1_3.h5',
        #     'datasets/whq11disgust1_4.h5',
        #     'datasets/whq11disgust1_5.h5',
        #     'datasets/whq11disgust1_6.h5',
        #     'datasets/whq11disgust2_1.h5',
        #     'datasets/whq11disgust2_2.h5',
        #     'datasets/whq11disgust2_3.h5',
        #     'datasets/whq11disgust2_4.h5',
        #     'datasets/whq11disgust2_5.h5',
        #     'datasets/whq11disgust2_6.h5',
        #     'datasets/whq11disgust2_7.h5',
        #     'datasets/whq11disgust2_8.h5',
        #     'datasets/whq11disgust2_9.h5',
        #     'datasets/whq11happy1_1.h5',
        #     'datasets/whq11happy1_2.h5',
        #     'datasets/whq11happy1_3.h5',
        #     'datasets/whq11happy1_4.h5',
        #     'datasets/whq11happy1_5.h5',
        #     'datasets/whq11happy1_6.h5',
        #     'datasets/whq11happy1_7.h5',
        #     'datasets/whq11happy2_1.h5',
        #     'datasets/whq11happy2_2.h5',
        #     'datasets/whq11happy2_3.h5',
        #     'datasets/whq11happy3_1.h5',
        #     'datasets/whq11happy3_2.h5',
        #     'datasets/whq11happy3_3.h5',
        #     'datasets/whq11happy4_1.h5',
        #     'datasets/whq11happy4_2.h5',
        #     'datasets/whq11happy4_3.h5',
        #     'datasets/whq11happy4_4.h5',
        #     'datasets/whq11happy5_1.h5',
        #     'datasets/whq12happy1_1.h5',
        #     'datasets/whq13anger1_1.h5',
        #     'datasets/whq13anger1_2.h5',
        #     'datasets/whq13anger1_3.h5',
        #     'datasets/whq13anger1_4.h5',
        #     'datasets/whq13disgust1_1.h5',
        #     'datasets/whq13disgust2_1.h5',
        #     'datasets/whq13disgust2_2.h5',
        #     'datasets/whq13happy1_1.h5',
        #     'datasets/whq13happy1_2.h5',
        #     'datasets/whq13happy1_3.h5',
        #     'datasets/whq13happy1_4.h5',
        #     'datasets/whq13happy1_5.h5',
        #     'datasets/whq13happy1_6.h5',
        #     'datasets/whq13happy2_1.h5',
        #     'datasets/whq13happy2_2.h5',
        #     'datasets/whq13happy3_1.h5',
        #     'datasets/whq13happy3_2.h5',
        #     'datasets/whq13happy4_1.h5',
        #     'datasets/whq13happy4_2.h5',
        #     'datasets/whq14anger1_1.h5',
        #     'datasets/whq14anger1_2.h5',
        #     'datasets/whq14anger1_3.h5',
        #     'datasets/whq14anger2_1.h5',
        #     'datasets/whq14anger2_10.h5',
        #     'datasets/whq14anger2_2.h5',
        #     'datasets/whq14anger2_3.h5',
        #     'datasets/whq14anger2_4.h5',
        #     'datasets/whq14anger2_5.h5',
        #     'datasets/whq14anger2_6.h5',
        #     'datasets/whq14anger2_7.h5',
        #     'datasets/whq14anger2_8.h5',
        #     'datasets/whq14anger2_9.h5',
        #     'datasets/whq14disgust1_1.h5',
        #     'datasets/whq14disgust1_2.h5',
        #     'datasets/whq14disgust1_3.h5',
        #     'datasets/whq14disgust1_4.h5',
        #     'datasets/whq14disgust1_5.h5',
        #     'datasets/whq14disgust1_6.h5',
        #     'datasets/whq14disgust1_7.h5',
        #     'datasets/whq14disgust1_8.h5',
        #     'datasets/whq14disgust1_9.h5',
        #     'datasets/whq14happy1_1.h5',
        #     'datasets/whq14happy2_1.h5',
        #     'datasets/whq14happy3_1.h5',
        #     'datasets/whq14happy3_2.h5',
        #     'datasets/whq14happy4_1.h5',
        #     'datasets/whq14happy4_2.h5',
        #     'datasets/whq14happy4_3.h5',
        #     'datasets/whq14happy4_4.h5',
        #     'datasets/whq14happy4_5.h5',
        #     'datasets/whq14happy4_6.h5',
        #     'datasets/whq15anger1_1.h5',
        #     'datasets/whq15anger1_10.h5',
        #     'datasets/whq15anger1_11.h5',
        #     'datasets/whq15anger1_12.h5',
        #     'datasets/whq15anger1_13.h5',
        #     'datasets/whq15anger1_14.h5',
        #     'datasets/whq15anger1_15.h5',
        #     'datasets/whq15anger1_2.h5',
        #     'datasets/whq15anger1_3.h5',
        #     'datasets/whq15anger1_4.h5',
        #     'datasets/whq15anger1_5.h5',
        #     'datasets/whq15anger1_6.h5',
        #     'datasets/whq15anger1_7.h5',
        #     'datasets/whq15anger1_8.h5',
        #     'datasets/whq15anger1_9.h5',
        #     'datasets/whq15anger2_1.h5',
        #     'datasets/whq15anger2_2.h5',
        #     'datasets/whq15anger2_3.h5',
        #     'datasets/whq15anger2_4.h5',
        #     'datasets/whq15anger2_5.h5',
        #     'datasets/whq15anger2_6.h5',
        #     'datasets/whq15anger2_7.h5',
        #     'datasets/whq15disgust1_1.h5',
        #     'datasets/whq15disgust1_2.h5',
        #     'datasets/whq15disgust2_1.h5',
        #     'datasets/whq15happy1_1.h5',
        #     'datasets/whq15happy1_2.h5',
        #     'datasets/whq15happy1_3.h5',
        #     'datasets/whq15happy1_4.h5',
        #     'datasets/whq15happy1_6.h5',
        #     'datasets/whq15happy1_7.h5',
        #     'datasets/whq15happy1_8.h5',
        #     'datasets/whq15happy2_1.h5',
        #     'datasets/whq15happy2_10.h5',
        #     'datasets/whq15happy2_11.h5',
        #     'datasets/whq15happy2_12.h5',
        #     'datasets/whq15happy2_13.h5',
        #     'datasets/whq15happy2_2.h5',
        #     'datasets/whq15happy2_3.h5',
        #     'datasets/whq15happy2_4.h5',
        #     'datasets/whq15happy2_5.h5',
        #     'datasets/whq15happy2_6.h5',
        #     'datasets/whq15happy2_7.h5',
        #     'datasets/whq15happy2_8.h5',
        #     'datasets/whq15happy2_9.h5',
        #     'datasets/whq15happy3_1.h5',
        #     'datasets/whq15happy3_2.h5',
        #     'datasets/whq15happy3_3.h5',
        #     'datasets/whq15happy3_4.h5',
        #     'datasets/whq15happy4_1.h5',
        #     'datasets/whq15happy4_2.h5',
        #     'datasets/whq15happy5_1.h5',
        #     'datasets/whq16anger2_1.h5',
        #     'datasets/whq16anger2_2.h5',
        #     'datasets/whq16disgust2_1.h5',
        #     'datasets/whq16disgust2_2.h5',
        #     'datasets/whq17anger1_1.h5',
        #     'datasets/whq17anger2_1.h5',
        #     'datasets/whq17happy2_1.h5',
        #     'datasets/whq18disgust2_1.h5',
        #     'datasets/whq18disgust2_2.h5',
        #     'datasets/whq19anger1_1.h5',
        #     'datasets/whq19happy3_1.h5',
        #     'datasets/whq19happy3_2.h5',
        #     'datasets/whq19happy3_3.h5',
        #     'datasets/whq20anger2_1.h5',
        #     'datasets/whq20anger2_2.h5',
        #     'datasets/whq20anger2_3.h5',
        #     'datasets/whq20anger2_4.h5',
        #     'datasets/whq20anger2_5.h5',
        #     'datasets/whq20disgust1_1.h5',
        #     'datasets/whq20happy1_1.h5',
        #     'datasets/whq20happy1_2.h5',
        #     'datasets/whq20happy3_1.h5',
        #     'datasets/whq20happy3_2.h5',
        #     'datasets/whq20happy3_3.h5',
        #     'datasets/whq20happy3_4.h5',
        #     'datasets/whq20happy3_5.h5',
        #     'datasets/whq20happy3_6.h5',
        #     'datasets/whq20happy4_1.h5',
        #     'datasets/whq20happy4_2.h5',
        #     'datasets/whq20happy4_3.h5',
        #     'datasets/whq20happy4_4.h5',
        #     'datasets/whq20happy4_5.h5',
        #     'datasets/whq20happy4_6.h5',
        #     'datasets/whq20happy5_1.h5',
        #     'datasets/whq20happy5_2.h5',
        #     'datasets/whq20happy5_3.h5',
        #     'datasets/whq21happy1_1.h5',
        #     'datasets/whq21happy1_2.h5',
        #     'datasets/whq21happy1_3.h5',
        #     'datasets/whq21happy1_4.h5',
        #     'datasets/whq21happy1_5.h5',
        #     'datasets/whq21happy1_6.h5',
        #     'datasets/whq21happy4_1.h5',
        #     'datasets/whq21happy4_2.h5',
        #     'datasets/whq21happy4_3.h5',
        #     'datasets/whq21happy4_4.h5',
        #     'datasets/whq21happy4_5.h5',
        #     'datasets/whq21happy4_6.h5',
        #     'datasets/whq22anger1_1.h5',
        #     'datasets/whq22anger1_2.h5',
        #     'datasets/whq22happy1_1.h5',
        #     'datasets/whq22happy1_2.h5',
        #     'datasets/whq22happy2_1.h5']

        # self.datasets=['datasets/wus1515_0102eatingworms.h5',
        #                 'datasets/wus1515_0502funnyerrors.h5',
        #                 'datasets/wus1616_0101disgustingteeth.h5',
        #                 'datasets/wus1616_0102eatingworms.h5',
        #                 'datasets/wus1616_0502funnyerrors.h5',
        #                 'datasets/wus1616_0505funnyinnovations.h5',
        #                 'datasets/wus1616_0507climbingthewall.h5',
        #                 'datasets/wus1919_0402beatingpregnantwoman.h5',
        #                 'datasets/wus2323_0102eatingworms.h5',
        #                 'datasets/wus2424_0401girlcrashing.h5',
        #                 'datasets/wus2525_0101disgustingteeth.h5',
        #                 'datasets/wus2525_0102eatingworms.h5',
        #                 'datasets/wus2727_0101disgustingteeth.h5',
        #                 'datasets/wus2727_0102eatingworms.h5',
        #                 'datasets/wus2727_0401girlcrashing.h5',
        #                 'datasets/wus2727_0502funnyerrors.h5',
        #                 'datasets/wus2727_0503unnyfarting.h5',
        #                 'datasets/wus2727_0507climbingthewall.h5',
        #                 'datasets/wus2929_0502funnyerrors.h5',
        #                 'datasets/wus3030_0101disgustingteeth.h5',
        #                 'datasets/wus3030_0401girlcrashing.h5',
        #                 'datasets/wus3131_0101disgustingteeth.h5',
        #                 'datasets/wus3131_0402beatingpregnantwoman.h5',
        #                 'datasets/wus3131_0505funnyinnovations.h5',
        #                 'datasets/wus3232_0401girlcrashing.h5',
        #                 'datasets/wus3232_0502funnyerrors.h5',
        #                 'datasets/wus3232_0503unnyfarting.h5',
        #                 'datasets/wus3232_0508funnydunkey.h5',
        #                 'datasets/wus3535_0102eatingworms.h5',
        #                 'datasets/wus3737_0402beatingpregnantwoman.h5',
        #                 'datasets/wus3737_0508funnydunkey.h5',
        #                 'datasets/wus3838_0507climbingthewall.h5']

        # self.datasets = ['datasets/wus1515_0101disgustingteeth.h5',
        #     'datasets/wus1616_0101disgustingteeth.h5',
        #     'datasets/wus1616_0102eatingworms.h5',
        #     'datasets/wus1616_0401girlcrashing.h5',
        #     'datasets/wus1616_0402beatingpregnantwoman.h5',
        #     'datasets/wus1919_0102eatingworms.h5',
        #     'datasets/wus2020_0502funnyerrors.h5',
        #     'datasets/wus2121_0101disgustingteeth.h5',
        #     'datasets/wus2222_0101disgustingteeth.h5',
        #     'datasets/wus2323_0102eatingworms.h5',
        #     'datasets/wus2424_0101disgustingteeth.h5',
        #     'datasets/wus2525_0101disgustingteeth.h5',
        #     'datasets/wus2626_0101disgustingteeth.h5',
        #     'datasets/wus2727_0101disgustingteeth.h5',
        #     'datasets/wus2727_0102eatingworms.h5',
        #     'datasets/wus2727_0401girlcrashing.h5',
        #     'datasets/wus3030_0101disgustingteeth.h5',
        #     'datasets/wus3030_0102eatingworms.h5',
        #     'datasets/wus3131_0101disgustingteeth.h5',
        #     'datasets/wus3131_0401girlcrashing.h5',
        #     'datasets/wus3232_0101disgustingteeth.h5',
        #     'datasets/wus3232_0102eatingworms.h5',
        #     'datasets/wus3232_0401girlcrashing.h5',
        #     'datasets/wus3232_0402beatingpregnantwoman.h5',
        #     'datasets/wus3333_0102eatingworms.h5',
        #     'datasets/wus3434_0401girlcrashing.h5',
        #     'datasets/wus3636_0401girlcrashing.h5',
        #     'datasets/wus3737_0101disgustingteeth.h5',
        #     'datasets/wus3737_0402beatingpregnantwoman.h5',
        #     'datasets/wus3838_0502funnyerrors.h5',
        #     'datasets/wus4040_0401girlcrashing.h5']

        # self.splits = ['splits/007_5_1_aug_splits.json'] #宏表情
        self.splits = ['splits/037_7_aug_splits.json']  # 与宏表情对应的无表情

        # self.splits = ['splits/whq2disgust1_3_aug_splits.json'] #微表情
        # self.splits = ['splits/whq22happy1_2_aug_splits.json']  #宏表情
        # self.splits = ['splits/wus1616_0101disgustingteeth_aug_splits.json'] #与微表情对应的无表情
        # self.splits = ['splits/wus4040_0401girlcrashing_aug_splits.json'] #与宏表情对应的无表情

        # self.datasets=['datasets/eccv16_dataset_summe_google_pool5.h5',
        #                'datasets/eccv16_dataset_tvsum_google_pool5.h5',
        #                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           'datasets/eccv16_dataset_ovp_google_pool5.h5',
        #                'datasets/eccv16_dataset_youtube_google_pool5.h5']
        #
        #
        # self.splits = ['splits/tvsum_splits.json',
        #                 'splits/summe_splits.json']

        # self.splits += ['splits/tvsum_aug_splits.json',
        #                 'splits/summe_aug_splits.json']


        return


    def get_dataset_by_name(self, dataset_name):
        for d in self.datasets:
            if dataset_name in d:
                return [d]
        return None

    def load_from_args(self, args):
        for key in args:
            val = args[key]
            if val is not None:
                if hasattr(self, key) and isinstance(getattr(self, key), list):
                    val = val.split()

                setattr(self, key, val)

    def __str__(self):
        vars = [attr for attr in dir(self) if not callable(getattr(self,attr)) and not (attr.startswith("__") or attr.startswith("_"))]

        info_str = ''
        for i, var in enumerate(vars):
            val = getattr(self, var)
            if isinstance(val, Variable):
                val = val.data.cpu().numpy().tolist()[0]
            info_str += '['+str(i)+'] '+var+': '+str(val)+'\n'

        return info_str


if __name__ == "__main__":

    # Tests
    hps = HParameters()
    print(hps)

    args = {'root': 'root_dir',
            'datasets': 'set1,set2,set3',
            'splits': 'split1, split2',
            'new_param_float': 1.23456
            }

    hps.load_from_args(args)
    print(hps)
